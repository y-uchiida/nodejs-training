# Commentary of training001
node.jsで、CUIから操作するプログラムを作成しました。  
Udemyの `Node.js速習講座 Part1 <導入＆基礎編>` の内容をベースにしています。  

## 始める前に その1…環境構築
Udemyの内容では、環境構築は最低限のことだけだったので。  
実際には複数のnode.jsのバージョンを利用したい場合が多いようなので、  
`brew` と `nodenv(anyenv)` でnodeをインストールする構成にしました。
なので、このリポジトリにもnodenv導入を前提として`.node-version` が含まれています。  
環境構築はいろいろの内容を調べながらやったのでコマンドの順番とかあまり覚えてないのと、  
今回扱う内容としては範囲外なのでcommentaryに含めません。。。

## 始める前に その2…npmの使いかた
node.jsを扱うにあたって、npmを理解することも重要なのですが、、、  
こちらも周辺的な内容なので、このcommentaryでは立ち入りません。  
概念を理解するのにとても役だった記事を紹介するにとどめます。  
【初心者向け】NPMとpackage.jsonを概念的に理解する:  
https://qiita.com/righteous/items/e5448cb2e7e11ab7d477  

新しくプロジェクトを作るときは、`npm init` してから　`npm install` をします。
githubでnode.js で書かれたリポジトリをcloneしてきた場合は `npm install` を実行すればOKです(package.jsonが含まれていれば)。  
とりあえずはそんな理解をしておけばコードを書き始められます。  
自分で作ったコードをgitで管理する場合、node_modulesの内容がリポジトリに含まれてしまわないように.gitignoreを記載しておくことも忘れずに。  

## ECMAScript 2015
ES6と呼ばれている、JavaScriptの新しい書式です。  
動作保証にIEを含むものばかり扱うウチイダにとっては、あまり接する機会のないやつでした…  
ので、node.jsをやるついでにES6にも少し慣れておこうと思います。  
ES6に特徴的な書式をいくつかまとめておくことにします。

### アロー演算子  
個人的に一番違和感があったのがこいつです。慣れ親しんだ `function(){}` となかなか差が大きいので。。。  
雑な理解ですが`function(arg)` を `(arg) => `と書き換えられるものだと思ってます。  

### letとconst  
変数の宣言時に使う`var` のほかに、 `let` と `const` が登場しました。  
`let`は再宣言禁止、`const`は再代入も禁止です。`var` は再宣言も再代入もOKでした。  
また、`var` が関数スコープだったのに対して `let` と`const` はブロックスコープです。  
宣言された直近のブロック内でのみ参照できます。  
なので、ifのブロック内で宣言したりすると、そのifブロックが終了したらもう使えなくなります。  
ゆるゆるだった`var` と同じ感覚で使ってるとエラーを食らいます。しょっちゅうです。  

### テンプレートリテラル
ES6 の書式の中で一番うれしかったのはこれです。
従来は文字列と変数をつなげたい場合は`+` 演算子でつなぐ必要がありましたが、  
ES6 では\`${var}\` と書くと、変数の値を文字列内で展開して表示してくれます。  

### for-of()
これも地味にうれしい新機能。  
従来のfor-in()だと、キーの方を持ってきちゃうので、値を操作したいときは`arr[key]`と書く必要がありました。
for-ofでは、値を直接取り出してくれるので、値を扱いたい場合にわざわざキー経由で参照しなくてもよくなりました。

### promise オブジェクト
非同期処理でこれまでお世話になっていたjQueryのDeferredとだいたい一緒です。  
複数の処理が全て終わってから次に進む、みたいな並列処理のときに、when()の代わりにall()を使う、とかくらいでしょうか。
  
  
これらのほかにも、大きな変更として`class` が追加されたとかもあるのですけど、  
JavaScriptでオブジェクト指向が求められるようなモノを実装してきた経験が無いのであまりピンと来てないです。。。  

ES6 の書式の振り返りはこのくらいにして、ここからようやくnode.jsの内容に入っていきます。

## モジュール(パッケージ)の利用：require()
nodeの組み込みパッケージやnpmパッケージを利用するためのものです。  
C言語の`#include` みたいなやつです。ちょっと違うか。

## module.exports()
別のファイルから読込された際に、その読み込み元のファイルから呼び出しできる関数や変数を設定するものです。  
なんだろう、PHPとかでいえば、public 宣言みたいなものでしょうか。ちょっと違うか。  
example.jsの中で、`module.exports.func = () => {}...` などとしてあると、  
別のファイルから`const ex = require(./exapmle)` とやれば、exオブジェクトを通じてexample.jsの関数が呼び出せるようになります。

## まとめ
以上です。  
本当にシンプルなプログラムしか書いてないので、特筆すべきことがあまりないです…  